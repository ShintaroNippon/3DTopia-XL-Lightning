name: "3dtopia-xl-shintaro"
description: "3DTopia-XL with NumPy compatibility fix for GLB generation"

image:
  build_context: "."
  dockerfile: "Dockerfile"

compute:
  gpu: "L4"
  memory: "24GB"
  disk_size: "80GB"
  cpu: "4"

ports:
  - "7860:7860"

env:
  - "TORCH_CUDA_ARCH_LIST=7.5 8.0 8.6+PTX"
  - "FORCE_CUDA=1"
  - "CUDA_VISIBLE_DEVICES=0"
  - "GRADIO_SERVER_NAME=0.0.0.0"
  - "GRADIO_SERVER_PORT=7860"
  - "NUMPY_VERSION=1.26.4"  # Force NumPy 1.x

volumes:
  - name: "models"
    mount_path: "/workspace/pretrained"
    size: "30GB"
  - name: "outputs"
    mount_path: "/workspace/outputs"
    size: "20GB"
  - name: "inputs"
    mount_path: "/workspace/inputs"
    size: "5GB"

startup_commands:
  - "/workspace/download_models.sh"
  - "python /workspace/enhanced_robot.py --prompt 'a futuristic robot'"